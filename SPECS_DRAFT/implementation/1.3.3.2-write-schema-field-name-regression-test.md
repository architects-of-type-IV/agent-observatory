---
id: "1.3.3.2"
title: "Write schema field name regression test via __schema__(:fields)"
status: pending
task_id: "1.3.3"
governed_by: ["ADR-014"]
parent_uc: ["UC-0208"]
---

goal: "Write test named 'UI derivation anchor field names are declared in the schema' that asserts each anchor field name is in the corresponding sub-schema's __schema__(:fields) list so that renames break this test and force a major version review"
allowed_files:
  - test/observatory/mesh/decision_log_test.exs
blocked_by: ["1.3.3.1"]
steps:
  - Assert DecisionLog.Meta.__schema__(:fields) includes :parent_step_id
  - Assert DecisionLog.Cognition.__schema__(:fields) includes :reasoning_chain and :entropy_score
  - Assert DecisionLog.StateDelta.__schema__(:fields) includes :cumulative_session_cost
  - Assert DecisionLog.Control.__schema__(:fields) includes :hitl_required and :is_terminal
done_when: "mix test test/observatory/mesh/decision_log_test.exs"
