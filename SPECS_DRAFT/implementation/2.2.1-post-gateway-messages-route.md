---
type: task
id: "2.2.1"
section_id: "2.2"
title: "POST /gateway/messages Route"
status: pending
governed_by: ["ADR-013", "ADR-015"]
parent_uc: ["UC-0211"]
---

# Task 2.2.1: POST /gateway/messages Route

## Goal

Add an `:api` pipeline to `lib/observatory_web/router.ex` with JSON body parsing and no session/browser authentication plugs. Declare `post "/gateway/messages"` in that pipeline. Create `lib/observatory_web/controllers/gateway_controller.ex` with a `create/2` action stub that calls `SchemaInterceptor.validate/1` first. Confirm that `POST /gateway/message` (singular, no trailing `s`) returns HTTP 404.

## Governing Decisions

- ADR-013
- ADR-015

## Verification UCs

- UC-0211

## Subtasks

| ID | Title | Done When | Status |
|----|-------|-----------|--------|
| 2.2.1.a | Add :api pipeline and gateway/messages scope to router.ex | mix compile --warnings-as-errors | pending |
| 2.2.1.b | Create gateway_controller.ex with create/2 calling SchemaInterceptor.validate/1 | mix compile --warnings-as-errors | pending |
| 2.2.1.c | Test that POST /gateway/message (singular) returns HTTP 404 | mix test test/observatory_web/controllers/gateway_controller_test.exs --only routing | pending |
| 2.2.1.d | Test that POST /gateway/messages with empty payload returns 422 | mix test test/observatory_web/controllers/gateway_controller_test.exs --only routing | pending |
