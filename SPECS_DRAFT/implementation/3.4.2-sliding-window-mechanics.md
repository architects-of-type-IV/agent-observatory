---
type: task
id: "3.4.2"
section_id: "3.4"
title: "Sliding Window Mechanics"
status: pending
governed_by: ["ADR-018"]
parent_uc: ["UC-0250"]
---

# Task 3.4.2: Sliding Window Mechanics

## Goal

The window for each session must hold the last N tuples in insertion order (N read from `Application.get_env(:observatory, :entropy_window_size, 5)` on each call). When a new tuple arrives and the window is at capacity, the oldest tuple is evicted. When fewer than N tuples have been received, the ratio is computed over the available entries.

## Governing Decisions

- ADR-018

## Verification UCs

- UC-0250

## Subtasks

| ID | Title | Done When | Status |
|----|-------|-----------|--------|
| 3.4.2.1 | Implement handle_call with ETS lookup, window append, cap-enforcement eviction, and ETS write-back | mix compile --warnings-as-errors | pending |
| 3.4.2.2 | Write tests for sixth tuple evicting oldest and score computed over 3 tuples equaling 1.0 | mix test test/observatory/gateway/entropy_tracker_test.exs | pending |
