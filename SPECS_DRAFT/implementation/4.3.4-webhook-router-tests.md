---
type: task
id: "4.3.4"
section_id: "4.3"
title: "WebhookRouter Tests"
status: pending
governed_by: ["ADR-020"]
parent_uc: ["UC-0267", "UC-0268", "UC-0269", "UC-0270", "UC-0279"]
---

# Task 4.3.4: WebhookRouter Tests

## Goal

Write ExUnit tests for retry schedule, signature validation, startup re-queuing, and thundering-herd cap behaviour.

## Governing Decisions

- ADR-020

## Verification UCs

- UC-0267
- UC-0268
- UC-0269
- UC-0270
- UC-0279

## Subtasks

| ID | Title | Done When | Status |
|----|-------|-----------|--------|
| 4.3.4.1 | Write tests for compute_outbound_signature sha256 prefix, retry delays, and status: dead after 5 failures | mix test test/observatory/gateway/webhook_router_test.exs | pending |
| 4.3.4.2 | Write WebhookDelivery changeset tests and polling query filter tests | mix test test/observatory/gateway/webhook_deliveries_test.exs | pending |
| 4.3.4.3 | Write webhook controller tests for valid signature creating pending row, tampered body returning 401, and failure event broadcast | mix test test/observatory_web/controllers/webhook_controller_test.exs | pending |
