---
id: "1.2.3.1"
title: "Add major_version/1 helper with nil-safe guard clause"
status: pending
task_id: "1.2.3"
governed_by: ["ADR-014"]
parent_uc: ["UC-0205", "UC-0206"]
---

goal: "Add def major_version/1 to Observatory.Mesh.DecisionLog that splits capability_version on dot, takes first element, and returns as integer; plus nil-safe guard returning nil"
allowed_files:
  - lib/observatory/mesh/decision_log.ex
blocked_by: ["1.1.2.2"]
steps:
  - Add def major_version(%__MODULE__{identity: %{capability_version: v}}) when is_binary(v)
  - Implement by splitting on ".", taking first element, and returning String.to_integer/1
  - Add def major_version(_), do: nil for structs where identity or capability_version is nil
  - Confirm mix compile --warnings-as-errors passes
done_when: "mix compile --warnings-as-errors"
