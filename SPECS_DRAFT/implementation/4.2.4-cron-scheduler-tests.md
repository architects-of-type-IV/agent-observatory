---
type: task
id: "4.2.4"
section_id: "4.2"
title: "CronScheduler Tests"
status: pending
governed_by: ["ADR-019"]
parent_uc: ["UC-0264", "UC-0265", "UC-0266"]
---

# Task 4.2.4: CronScheduler Tests

## Goal

Write ExUnit tests covering the `schedule_once/3` public API, startup recovery, invalid delay rejection, and the SchemaInterceptor extension.

## Governing Decisions

- ADR-019

## Verification UCs

- UC-0264
- UC-0265
- UC-0266

## Subtasks

| ID | Title | Done When | Status |
|----|-------|-----------|--------|
| 4.2.4.1 | Write tests for schedule_once returning :ok with DB row, timer firing PubSub broadcast, and row deletion after fire | mix test test/observatory/gateway/cron_scheduler_test.exs | pending |
| 4.2.4.2 | Write tests for invalid delay (0 and -500) returning {:error, :invalid_delay} and past-due job startup recovery | mix test test/observatory/gateway/cron_scheduler_test.exs | pending |
