Observatory Progress
====================

## Current: Swarm Control Center (2026-02-21)

### Completed
- [x] Nav redesign: 9 tabs -> 4 primary (Overview, Protocols, Feed, Errors) + More dropdown
- [x] Overview tab: Command + Pipeline + Agents stacked
- [x] SwarmMonitor GenServer (tasks.jsonl, health-check.sh, DAG)
- [x] ProtocolTracker GenServer (cross-protocol message tracing)
- [x] Command view (agent grid, health bar, alerts, detail panel)
- [x] Pipeline view (DAG waves, task table, project selector)
- [x] Protocols view (message flow, channel stats)
- [x] DashboardSwarmHandlers (all event handlers)
- [x] TeamWatcher: preserve cwd, model, color, joined_at fields
- [x] Mailbox.get_stats/0, CommandQueue.get_queue_stats/0
- [x] Supervision tree updated
- [x] JS keyboard shortcuts 1-4 + MoreDropdown hook
- [x] Live test: server starts, pages render, zero runtime errors
- [x] SwarmMonitor discovers memories project from team config

- [x] Feed: segment-based architecture with subagent blocks
  - Investigated real SubagentStart/SubagentStop payloads in Observatory DB (264 events)
  - Discovered: subagent events fire on PARENT session_id with short hash agent_id
  - Rewrote dashboard_feed_helpers.ex: segment_by_spans splits events into parent/subagent segments
  - Rewrote session_group.ex: renders segments with collapsible subagent blocks (cyan-themed)
  - Collapse/expand at both session level AND subagent level (MapSet keys: session_id, "sub:{agent_id}")
- [x] Build: zero warnings

### Remaining
- [ ] Visual verification: open browser, click through all views
- [ ] Test feed with active agents spawning subagents
- [ ] Test DAG rendering with real pipeline running
