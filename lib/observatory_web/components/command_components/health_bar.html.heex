<div class="bg-zinc-900/50 border border-zinc-800 rounded-lg p-4">
  <div class="flex items-center justify-between gap-4">
    <%!-- Health indicator --%>
    <div class="flex items-center gap-3">
      <div class={[
        "flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium",
        if(@health.healthy,
          do: "bg-emerald-500/15 text-emerald-400 border border-emerald-500/30",
          else: "bg-red-500/15 text-red-400 border border-red-500/30"
        )
      ]}>
        <span class={[
          "w-2 h-2 rounded-full",
          if(@health.healthy, do: "bg-emerald-400", else: "bg-red-400 animate-pulse")
        ]} />
        <%= if @health.healthy do %>
          Healthy
        <% else %>
          {length(@health.issues)} issues
        <% end %>
      </div>

      <%!-- Project selector --%>
      <div :if={map_size(@projects) > 0} class="flex items-center gap-2">
        <span class="text-xs text-zinc-500">Pipeline:</span>
        <form phx-change="select_project" class="inline">
          <select
            name="project"
            class="bg-zinc-800 border border-zinc-700 rounded px-2 py-1 text-xs text-zinc-300 focus:border-indigo-500 focus:ring-0 focus:outline-none"
          >
            <option :for={{key, _path} <- @projects} value={key} selected={key == @active_project}>
              {key}
            </option>
          </select>
        </form>
      </div>
    </div>

    <%!-- Pipeline progress --%>
    <div :if={@pipeline.total > 0} class="flex-1 max-w-md">
      <div class="flex items-center justify-between text-xs text-zinc-500 mb-1">
        <span>{@pipeline.completed}/{@pipeline.total} tasks</span>
        <span>{@progress_pct}%</span>
      </div>
      <div class="h-2.5 bg-zinc-800 rounded-full overflow-hidden">
        <div
          class="h-full bg-emerald-500 rounded-full transition-all duration-500"
          style={"width: #{@progress_pct}%"}
        />
      </div>
    </div>

    <%!-- Action buttons --%>
    <div class="flex items-center gap-2">
      <button
        :if={length(@stale) > 0}
        phx-click="reset_all_stale"
        class="px-2 py-1 bg-amber-600/20 text-amber-400 rounded text-xs hover:bg-amber-600/30 transition"
      >
        Heal {length(@stale)} stale
      </button>
      <button
        phx-click="run_health_check"
        class="px-2 py-1 bg-zinc-700 text-zinc-300 rounded text-xs hover:bg-zinc-600 transition"
      >
        Check Health
      </button>
    </div>
  </div>
</div>
