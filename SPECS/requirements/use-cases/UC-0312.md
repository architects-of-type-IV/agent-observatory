---
id: UC-0312
title: Apply Danger Zone Styling to God Mode Controls
status: draft
parent_fr: FR-12.12
adrs: [ADR-022]
---

# UC-0312: Apply Danger Zone Styling to God Mode Controls

## Intent
All interactive controls in the God Mode view must use visually distinct danger-zone styling that immediately signals elevated-risk context to the operator. This is enforced via dedicated CSS classes (`god-mode-panel`, `god-mode-button-danger`, `god-mode-border`) defined in the application stylesheet — not inline styles. The Global Instructions editor must be bordered in amber or red. The `GodModeComponents` module must not reuse button component variants from other views; it must use danger-variant calls or explicitly named CSS classes. This UC validates that the visual distinction is structurally enforced in rendered HTML, not just cosmetically applied.

## Primary Actor
DashboardLive

## Supporting Actors
- GodModeComponents module (`lib/observatory_web/components/god_mode_components.ex`)
- Application stylesheet (CSS class definitions for `god-mode-panel`, `god-mode-button-danger`, `god-mode-border`)
- Kill-switch button element
- Global Instructions editor element
- Action container elements

## Preconditions
- DashboardLive is mounted with `view_mode: :god_mode`.
- The application stylesheet defines `god-mode-panel`, `god-mode-button-danger`, and `god-mode-border` classes with red background or border styling.
- No inline `style` attributes are used on God Mode action containers or buttons.

## Trigger
`DashboardLive.render/1` is invoked with `view_mode: :god_mode`, calling `GodModeComponents.god_mode_view(assigns)`.

## Main Success Flow
1. `GodModeComponents.god_mode_view(assigns)` renders the God Mode layout.
2. All primary action container elements carry the `god-mode-panel` CSS class.
3. The kill-switch button element carries the `god-mode-button-danger` CSS class.
4. The "Push to all" button for Global Instructions carries the `god-mode-button-danger` CSS class.
5. The Global Instructions editor container carries the `god-mode-border` CSS class.
6. No primary action button in the God Mode view uses the standard `primary-button` CSS class.
7. No action container or button uses an inline `style` attribute for color or border styling.

## Alternate Flows
None. This UC has no branching flow — the styling requirement is unconditional whenever `view_mode: :god_mode` is rendered.

## Failure Flows
### F1: Standard primary button class used for the kill-switch button
Condition: A developer uses the standard `primary-button` class (or an equivalent safe-action variant) on the kill-switch button.
Steps:
1. The rendered HTML for the kill-switch button contains `class="primary-button"` but not `god-mode-button-danger`.
2. A code review check or style lint detects the absence of `god-mode-button-danger`.
Result: The build or review process flags the deviation; the standard class must be replaced with the danger variant before merging.

### F2: Inline style attribute used on an action container
Condition: A developer uses `style="border: 2px solid red;"` on a God Mode action container instead of `god-mode-panel`.
Steps:
1. The rendered HTML contains an inline `style` attribute with color or border values.
2. A test or lint rule detects inline styles on God Mode elements.
Result: The inline style must be replaced with the `god-mode-panel` CSS class from the application stylesheet.

## Gherkin Scenarios

### S1: God Mode renders kill-switch button with god-mode-button-danger class
```gherkin
Scenario: Kill-switch button carries the danger CSS class when God Mode renders
  Given the DashboardLive socket has view_mode assigned as :god_mode
  When GodModeComponents.god_mode_view/1 is invoked
  Then the rendered HTML contains a button element with class "god-mode-button-danger"
  And that button element does not have class "primary-button"
```

### S2: God Mode action containers carry god-mode-panel class without inline styles
```gherkin
Scenario: God Mode action containers use CSS class not inline styles
  Given the DashboardLive socket has view_mode assigned as :god_mode
  When GodModeComponents.god_mode_view/1 is invoked
  Then the rendered HTML contains elements with class "god-mode-panel"
  And no element within the God Mode layout has an inline style attribute containing "border" or "color"
```

### S3: Global Instructions editor carries god-mode-border class
```gherkin
Scenario: Global Instructions editor container carries the border danger class
  Given the DashboardLive socket has view_mode assigned as :god_mode
  When GodModeComponents.god_mode_view/1 is invoked
  Then the rendered HTML contains the global-instructions editor container with class "god-mode-border"
```

## Acceptance Criteria
- [ ] `mix test test/observatory_web/live/god_mode_test.exs` passes a test that mounts with `view_mode: :god_mode` and asserts the rendered HTML contains at least one element with class `god-mode-button-danger` and at least one with class `god-mode-panel`.
- [ ] `mix test test/observatory_web/live/god_mode_test.exs` passes a test that asserts no button element within the God Mode view has the class `primary-button`.
- [ ] `mix test test/observatory_web/live/god_mode_test.exs` passes a test that asserts the Global Instructions editor container has class `god-mode-border`.
- [ ] `mix compile --warnings-as-errors` passes.

## Data
**Inputs:** `view_mode: :god_mode` socket assign
**Outputs:** Rendered HTML with `god-mode-panel`, `god-mode-button-danger`, and `god-mode-border` CSS classes on appropriate elements
**State changes:** Read-only — styling is structural, not runtime state.

## Traceability
- Parent FR: FR-12.12
- ADR: [ADR-022](../../decisions/ADR-022-six-view-ui-architecture.md)
