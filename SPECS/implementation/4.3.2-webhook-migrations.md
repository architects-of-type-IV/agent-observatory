---
type: task
id: "4.3.2"
section_id: "4.3"
title: "webhook_deliveries and webhook_configs Migrations"
status: pending
governed_by: ["ADR-020"]
parent_uc: ["UC-0279"]
---

# Task 4.3.2: webhook_deliveries and webhook_configs Migrations

## Goal

Create the two Ecto migrations and the `Observatory.Gateway.WebhookDelivery` Ecto schema. The `webhook_deliveries` table must have a compound index on `(status, next_retry_at)` to support efficient polling. The companion `webhook_configs` table maps `{source_identifier, event_type}` pairs to `{agent_intent, target_session}`.

## Governing Decisions

- ADR-020

## Verification UCs

- UC-0279

## Subtasks

| ID | Title | Done When | Status |
|----|-------|-----------|--------|
| 4.3.2.1 | Generate and populate migration creating webhook_configs and webhook_deliveries tables | mix ecto.migrate && mix compile --warnings-as-errors | pending |
| 4.3.2.2 | Add compound index on (status, next_retry_at) to webhook_deliveries | mix ecto.migrate && mix compile --warnings-as-errors | pending |
| 4.3.2.3 | Create webhook_delivery.ex with Ecto.Schema and changeset/2 validating required fields | mix compile --warnings-as-errors | pending |
