{"id":"1","status":"pending","subject":"Rewrite Action Status Enum & Causal Link Fields (Section 1.2)","description":"Section 1.2 subtasks: - [ ] 1.2.1.1 In `test/observatory/mesh/decision_log_test.exs`, write a parameterized test that calls `DecisionLog.changeset(%DecisionLog{}, params)` with `action.status` set to each of `\"success\"`, `\"failure\"`, `\"pending\"`, and `\"skipped\"` in turn and asserts `Ecto.Changeset.valid?(changeset) == true` and `apply_changes(changeset).action.status` equals the corresponding atom for each case `done_when: \"mix test test/observatory/mesh/decision_log_test.exs\"` - [ ] 1.2.1.2 In `test/observatory/mesh/decision_log_test.exs`, write a test that calls `DecisionLog.changeset(%DecisionLog{}, params)` with `action.status` set to `\"timeout\"` (all other required fields present) and asserts `Ecto.Changeset.valid?(changeset) == false` and the changeset errors include `{:status, {\"is invalid\", [validation: :inclusion, enum: [:success, :failure, :pending, :skipped]]}}` on the action embed `done_when: \"mix test test/observatory/mesh/decision_log_test.exs\"` - [ ] 1.2.2.1 In `meta_changeset/2` in `lib/observatory/mesh/decision_log.ex`, add a `update_change(changeset, :parent_step_id, fn val -> if val == \"\", do: nil, else: val end)` step after `cast/3` and before any format validation, so that an empty string input is stored as nil; add `def root?(%__MODULE__{meta: %{parent_step_id: nil}}), do: true` and `def root?(%__MODULE__{}), do: false` to `Observatory.Mesh.DecisionLog` `done_when: \"mix compile --warnings-as-errors\"` - [ ] 1.2.2.2 In `test/observatory/mesh/decision_log_test.exs`, write three tests: (a) params omitting `parent_step_id` produces a struct with `meta.parent_step_id == nil` and changeset valid; (b) params with `\"parent_step_id\" => \"\"` produces a struct with `meta.parent_step_id == nil` and no changeset error on `:parent_step_id`; (c) params with a valid UUID string produces a struct with `meta.parent_step_id` equal to that UUID string; then write two additional tests verifying `DecisionLog.root?/1` returns `true` for a struct with `meta.parent_step_id: nil` and `false` f","goal":"Section 1.2 compiles from scratch matching its FRD exactly","acceptance_criteria":["mix compile --warnings-as-errors","mix test test/observatory/mesh/decision_log_test.exs"],"priority":"high","blocked_by":[],"files":["lib/observatory/mesh/decision_log.ex","test/observatory/mesh/decision_log_test.exs"],"done_when":"mix compile --warnings-as-errors","owner":"","created":"2026-02-22T02:11:04Z","updated":"2026-02-22T02:11:04Z","tags":["phase-1","action-status-enum-causal-link-fields","section-1.2"],"roadmap_ref":"1.2","notes":""}
{"id":"2","status":"pending","subject":"Rewrite DecisionLog Module & Embedded Schema (Section 1.1)","description":"Section 1.1 subtasks: - [ ] 1.1.1.1 Create `lib/observatory/mesh/decision_log.ex` with `use Ecto.Schema` and `@primary_key false`, open an `embedded_schema do` block, and confirm `mix compile --warnings-as-errors` passes with an empty schema body `done_when: \"mix compile --warnings-as-errors\"` - [ ] 1.1.1.2 Define `embeds_one :meta, Meta, primary_key: false` as an inline inner schema with fields: `field :trace_id, :string`, `field :timestamp, :utc_datetime`, `field :parent_step_id, :string`, `field :cluster_id, :string` `done_when: \"mix compile --warnings-as-errors\"` - [ ] 1.1.1.3 Define `embeds_one :identity, Identity, primary_key: false` as an inline inner schema with fields: `field :agent_id, :string`, `field :agent_type, :string`, `field :capability_version, :string` `done_when: \"mix compile --warnings-as-errors\"` - [ ] 1.1.1.4 Define `embeds_one :cognition, Cognition, primary_key: false` as an inline inner schema with fields: `field :intent, :string`, `field :reasoning_chain, {:array, :string}`, `field :confidence_score, :float`, `field :strategy_used, :string`, `field :entropy_score, :float` `done_when: \"mix compile --warnings-as-errors\"` - [ ] 1.1.1.5 Define `embeds_one :action, Action, primary_key: false` as an inline inner schema with fields: `field :status, Ecto.Enum, values: [:success, :failure, :pending, :skipped]`, `field :tool_call, :string`, `field :tool_input, :string`, `field :tool_output_summary, :string` `done_when: \"mix compile --warnings-as-errors\"` - [ ] 1.1.1.6 Define `embeds_one :state_delta, StateDelta, primary_key: false` as an inline inner schema with fields: `field :added_to_memory, {:array, :string}`, `field :tokens_consumed, :integer`, `field :cumulative_session_cost, :float`; and define `embeds_one :control, Control, primary_key: false` with fields: `field :hitl_required, :boolean, default: false`, `field :interrupt_signal, :string`, `field :is_terminal, :boolean, default: false` `done_when: \"mix compile --warnings-as-errors\"` - [ ] 1.1.2.1 Implement `def c","goal":"Section 1.1 compiles from scratch matching its FRD exactly","acceptance_criteria":["mix compile --warnings-as-errors","mix test test/observatory/mesh/decision_log_test.exs"],"priority":"high","blocked_by":[],"files":["lib/observatory/mesh/decision_log.ex","test/observatory/mesh/decision_log_test.exs"],"done_when":"mix compile --warnings-as-errors","owner":"","created":"2026-02-22T02:11:04Z","updated":"2026-02-22T02:11:04Z","tags":["phase-1","decisionlog-module-embedded-schema","section-1.1"],"roadmap_ref":"1.1","notes":""}
{"id":"3","status":"pending","subject":"Rewrite Entropy Score Overwrite & Deserialization (Section 1.3)","description":"Section 1.3 subtasks: - [ ] 1.3.1.1 Add `def put_gateway_entropy_score(%__MODULE__{cognition: nil} = log, _score), do: log` and `def put_gateway_entropy_score(%__MODULE__{cognition: cognition} = log, score) when is_float(score)` to `Observatory.Mesh.DecisionLog`, where the second clause returns `%{log | cognition: %{cognition | entropy_score: score}}` `done_when: \"mix compile --warnings-as-errors\"` - [ ] 1.3.1.2 In `test/observatory/mesh/decision_log_test.exs`, write two tests: (a) build a `%DecisionLog{}` struct with `cognition.entropy_score: 0.9` via `apply_changes/1`, call `DecisionLog.put_gateway_entropy_score(log, 0.15)`, and assert the returned struct has `cognition.entropy_score == 0.15`; (b) build a `%DecisionLog{}` struct with `cognition: nil`, call `DecisionLog.put_gateway_entropy_score(log, 0.15)`, and assert the returned struct still has `cognition: nil` and no error is raised `done_when: \"mix test test/observatory/mesh/decision_log_test.exs\"` - [ ] 1.3.2.1 Add `def from_json(attrs) when is_map(attrs)` to `Observatory.Mesh.DecisionLog` that calls `changeset(%__MODULE__{}, attrs)`, then returns `{:ok, Ecto.Changeset.apply_changes(cs)}` if `cs.valid?` is true or `{:error, cs}` if `cs.valid?` is false `done_when: \"mix compile --warnings-as-errors\"` - [ ] 1.3.2.2 In `test/observatory/mesh/decision_log_test.exs`, write three tests: (a) `DecisionLog.from_json/1` with a valid string-keyed map returns `{:ok, %DecisionLog{}}` and the struct has all required fields populated; (b) `from_json/1` with a map containing `\"action\" => %{\"status\" => \"timeout\"}` returns `{:error, changeset}` where `changeset.valid? == false` and the changeset errors include an `:status` inclusion error; (c) `from_json/1` with a map missing `\"meta\"` entirely returns `{:error, changeset}` where the errors include a `:trace_id` required error `done_when: \"mix test test/observatory/mesh/decision_log_test.exs\"` - [ ] 1.3.3.1 In `test/observatory/mesh/decision_log_test.exs`, write a test named `\"UI derivation anchor ","goal":"Section 1.3 compiles from scratch matching its FRD exactly","acceptance_criteria":["mix compile --warnings-as-errors","mix test test/observatory/mesh/decision_log_test.exs"],"priority":"high","blocked_by":[],"files":["test/observatory/mesh/decision_log_test.exs"],"done_when":"mix compile --warnings-as-errors","owner":"","created":"2026-02-22T02:11:04Z","updated":"2026-02-22T02:11:04Z","tags":["phase-1","entropy-score-overwrite-deserialization","section-1.3"],"roadmap_ref":"1.3","notes":""}
{"id":"4","status":"pending","subject":"Generate migrations and run full test suite (Phase 1 final)","description":"Final integration task for Phase 1. Generate any pending migrations, apply them, and run the complete test suite with zero failures and zero warnings. Adapt commands to the project build system.","goal":"All Phase 1 changes integrated, full test suite green","acceptance_criteria":["All pending migrations/schema changes applied","Full test suite passes with 0 failures","Build passes with zero warnings"],"priority":"critical","blocked_by":["1","2","3"],"files":[],"done_when":"echo Verify: build clean + tests green","owner":"","created":"2026-02-22T02:11:04Z","updated":"2026-02-22T02:11:04Z","tags":["phase-1","migration","final"],"roadmap_ref":"1.final","notes":"Blocks on ALL other tasks. Run all schema changes and tests in one final pass."}
