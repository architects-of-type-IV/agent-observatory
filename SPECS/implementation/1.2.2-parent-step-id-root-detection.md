---
type: task
id: "1.2.2"
section_id: "1.2"
title: "parent_step_id Root Detection"
status: pending
governed_by: ["ADR-014", "ADR-017"]
parent_uc: ["UC-0204"]
---

# Task 1.2.2: parent_step_id Root Detection

## Goal

The `meta.parent_step_id` field is optional: nil marks a DAG root, a UUID string marks a child node. A preprocessing step in `meta_changeset/2` must convert any empty string to nil before validation runs, preventing blank strings from masquerading as UUID references. The `DecisionLog.root?/1` helper provides a named predicate for callers that need to test DAG root membership without inspecting internal fields directly.

## Governing Decisions

- ADR-014
- ADR-017

## Verification UCs

- UC-0204

## Subtasks

| ID | Title | Done When | Status |
|----|-------|-----------|--------|
| 1.2.2.1 | Add empty-string-to-nil update_change and root?/1 predicate | mix compile --warnings-as-errors | pending |
| 1.2.2.2 | Write tests for nil, empty string, UUID parent_step_id and root?/1 | mix test test/observatory/mesh/decision_log_test.exs | pending |
