---
id: "1.2.2.1"
title: "Add empty-string-to-nil update_change and root?/1 predicate"
status: pending
task_id: "1.2.2"
governed_by: ["ADR-014", "ADR-017"]
parent_uc: ["UC-0204"]
---

goal: "Add update_change in meta_changeset/2 to convert empty string parent_step_id to nil, and add def root?/1 predicate functions to Observatory.Mesh.DecisionLog"
allowed_files:
  - lib/observatory/mesh/decision_log.ex
blocked_by: ["1.1.2.2"]
steps:
  - In meta_changeset/2, add update_change(changeset, :parent_step_id, fn val -> if val == "", do: nil, else: val end) after cast/3
  - Add def root?(%__MODULE__{meta: %{parent_step_id: nil}}), do: true
  - Add def root?(%__MODULE__{}), do: false
  - Confirm mix compile --warnings-as-errors passes
done_when: "mix compile --warnings-as-errors"
