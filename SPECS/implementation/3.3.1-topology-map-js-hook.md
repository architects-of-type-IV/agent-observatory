---
type: task
id: "3.3.1"
section_id: "3.3"
title: "TopologyMap JS Hook Structure"
status: pending
governed_by: ["ADR-016"]
parent_uc: ["UC-0238"]
---

# Task 3.3.1: TopologyMap JS Hook Structure

## Goal

The `TopologyMap` LiveView JS hook must initialize the Canvas 2D context, register for `topology_update` events, attach a click listener, and start the `requestAnimationFrame` animation loop â€” all without importing any npm package. If the canvas element is absent at mount time, the hook must log an error and abort cleanly.

## Governing Decisions

- ADR-016

## Verification UCs

- UC-0238

## Subtasks

| ID | Title | Done When | Status |
|----|-------|-----------|--------|
| 3.3.1.1 | Create assets/js/hooks/topology_map.js with empty TopologyMap object and export | mix compile --warnings-as-errors | pending |
| 3.3.1.2 | Implement mounted() with canvas lookup, ctx init, handleEvent, click listener, startAnimationLoop | mix compile --warnings-as-errors | pending |
| 3.3.1.3 | Implement startAnimationLoop() with requestAnimationFrame and destroyed() with cancelAnimationFrame | mix compile --warnings-as-errors | pending |
| 3.3.1.4 | Register TopologyMap hook in assets/js/app.js Hooks object | mix compile --warnings-as-errors | pending |
