{"id":"5","status":"pending","subject":"Rewrite Six-View Navigation Shell (Section 5.1)","description":"Section 5.1 subtasks: - [ ] 5.1.1.1 In `lib/observatory_web/live/dashboard_live.ex`, add `@valid_view_modes ~w(fleet_command session_cluster registry scheduler forensic god_mode)a` as a module attribute; in `mount/3`, add `|> assign(:view_mode, :fleet_command)` before the `prepare_assigns/1` call `done_when: \"mix compile --warnings-as-errors\"` - [ ] 5.1.1.2 In `assets/js/app.js` (or the appropriate hooks file), add a `ViewModePersistence` hook with an `mounted()` callback that reads localStorage key `\"view_mode\"`, validates it against the set `[\"fleet_command\", \"session_cluster\", \"registry\", \"scheduler\", \"forensic\", \"god_mode\"]` inside a `try/catch`, and pushes `{event: \"restore_view_mode\", payload: {value: storedValue}}` to the LiveView only when the value is in the valid set; registers the hook in the LiveSocket hooks map `done_when: \"mix compile --warnings-as-errors\"` - [ ] 5.1.1.3 In `lib/observatory_web/live/dashboard_navigation_handlers.ex`, add `def handle_event(\"restore_view_mode\", %{\"value\" => value}, socket)` with a case clause matching each of the six valid string values to their corresponding atom (e.g., `\"fleet_command\" -> :fleet_command`), calling `assign(socket, :view_mode, atom)` and writing the value to localStorage via `push_event`; add a catch-all clause `_ ->` that calls `Logger.warning(\"Unrecognized view_mode: #{inspect(value)}\")` and assigns `view_mode: :fleet_command` `done_when: \"mix compile --warnings-as-errors\"` - [ ] 5.1.1.4 Write `mix test test/observatory_web/live/dashboard_live_test.exs` tests asserting: (a) DashboardLive mounts with `socket.assigns.view_mode == :fleet_command` before any client events; (b) pushing `restore_view_mode` with `\"scheduler\"` updates `view_mode` to `:scheduler`; (c) pushing `restore_view_mode` with legacy value `\"command\"` results in `view_mode: :fleet_command` and emits a warning log; (d) pushing `restore_view_mode` with each of the eight legacy atoms (`\"pipeline\"`, `\"agents\"`, `\"protocols\"`, `\"feed\"`, `\"errors\"`, `\"analytics\"`, ","goal":"Section 5.1 compiles from scratch matching its FRD exactly","acceptance_criteria":["mix compile --warnings-as-errors","mix test test/observatory_web/live/dashboard_live_test.exs"],"priority":"high","blocked_by":[],"files":["lib/observatory_web/components/fleet_command_components.ex","lib/observatory_web/live/dashboard_live.ex","lib/observatory_web/live/dashboard_navigation_handlers.ex","test/observatory_web/live/dashboard_live_test.exs"],"done_when":"mix compile --warnings-as-errors","owner":"","created":"2026-02-22T13:16:59Z","updated":"2026-02-22T13:16:59Z","tags":["phase-5","six-view-navigation-shell","section-5.1"],"roadmap_ref":"5.1","notes":""}
{"id":"1","status":"pending","subject":"Rewrite Fleet Command View (Section 5.2)","description":"Section 5.2 subtasks: - [ ] 5.2.1.1 Replace the stub in `lib/observatory_web/components/fleet_command_components.ex` with a full `fleet_command_view/1` function component that renders: a `<div id=\"mesh-topology-canvas\">` container (placeholder for the Canvas component from Phase 3), a `<div id=\"throughput-panel\">` showing `assigns[:throughput_rate] || \"Loading...\"`, a `<div id=\"cost-heatmap-panel\">` showing per-agent cost data from `assigns[:cost_heatmap] || []`, a `<div id=\"infrastructure-health-panel\">` showing `assigns[:node_status] || \"Loading...\"`, a `<div id=\"latency-panel\">` showing p50/p95/p99 from `assigns[:latency_metrics] || %{}`, and a `<div id=\"mtls-status-panel\">` showing `assigns[:mtls_status] || \"Loading...\"` `done_when: \"mix compile --warnings-as-errors\"` - [ ] 5.2.1.2 Add `|> assign(:throughput_rate, nil) |> assign(:cost_heatmap, []) |> assign(:node_status, nil) |> assign(:latency_metrics, %{}) |> assign(:mtls_status, nil)` to the `mount/3` chain in `lib/observatory_web/live/dashboard_live.ex`; add a `handle_info({:swarm_update, payload}, socket)` clause in `lib/observatory_web/live/dashboard_swarm_handlers.ex` that destructures `payload` into the relevant assigns `done_when: \"mix compile --warnings-as-errors\"` - [ ] 5.2.1.3 Add a collapsible agent grid sub-panel to `fleet_command_view/1`: a toggle button with `phx-click=\"toggle_agent_grid\"` and a conditional `<div id=\"agent-grid-panel\">` that renders existing `CommandComponents` sub-components when `assigns[:agent_grid_open]` is true; add `|> assign(:agent_grid_open, false)` to `mount/3`; add `handle_event(\"toggle_agent_grid\", _, socket)` in `dashboard_ui_handlers.ex` that toggles `agent_grid_open` `done_when: \"mix compile --warnings-as-errors\"` - [ ] 5.2.1.4 Write tests in `test/observatory_web/live/fleet_command_test.exs` asserting: (a) mounting with `view_mode: :fleet_command` and swarm mesh assigns populated renders all six container elements (`mesh-topology-canvas`, `throughput-panel`, `cost-heatmap-panel`, `infra","goal":"Section 5.2 compiles from scratch matching its FRD exactly","acceptance_criteria":["mix compile --warnings-as-errors","mix test test/observatory_web/live/fleet_command_test.exs"],"priority":"high","blocked_by":["5"],"files":["lib/observatory_web/components/fleet_command_components.ex","lib/observatory_web/live/dashboard_data_helpers.ex","lib/observatory_web/live/dashboard_live.ex","lib/observatory_web/live/dashboard_swarm_handlers.ex","test/observatory_web/live/fleet_command_test.exs"],"done_when":"mix compile --warnings-as-errors","owner":"","created":"2026-02-22T13:16:59Z","updated":"2026-02-22T13:16:59Z","tags":["phase-5","fleet-command-view","section-5.2"],"roadmap_ref":"5.2","notes":""}
{"id":"4","status":"pending","subject":"Rewrite Session Cluster and Registry Views (Section 5.3)","description":"Section 5.3 subtasks: - [ ] 5.3.1.1 Replace the stub in `lib/observatory_web/components/session_cluster_components.ex` with a `session_cluster_view/1` function component that renders: a filter toggle button with `phx-click=\"toggle_entropy_filter\"`, a session list that iterates `assigns[:sessions] || []` filtered by `entropy_filter_active`, and a `<div id=\"session-cluster-view\">` wrapper; each session row must have `phx-click=\"select_session\"` with `phx-value-session_id` set to the session ID; when the filtered list is empty, render `<p class=\"empty-state\">No high-entropy sessions.</p>` `done_when: \"mix compile --warnings-as-errors\"` - [ ] 5.3.1.2 Add `|> assign(:sessions, []) |> assign(:entropy_filter_active, false) |> assign(:entropy_threshold, 0.7) |> assign(:selected_session_id, nil)` to `mount/3`; add `handle_event(\"toggle_entropy_filter\", _, socket)` in `dashboard_navigation_handlers.ex` toggling `entropy_filter_active`; add `handle_event(\"select_session\", %{\"session_id\" => id}, socket)` setting `selected_session_id: id` `done_when: \"mix compile --warnings-as-errors\"` - [ ] 5.3.1.3 Write tests in `test/observatory_web/live/session_cluster_test.exs` asserting: (a) sending `select_session` with `session_id: \"sess-xyz-789\"` sets `selected_session_id` to `\"sess-xyz-789\"` and rendered HTML contains `causal-dag-panel`, `live-scratchpad-panel`, and `hitl-console-panel` elements; (b) activating entropy filter with all sessions below threshold renders the empty-state message and no exception is raised `done_when: \"mix test test/observatory_web/live/session_cluster_test.exs\"` - [ ] 5.3.2.1 In `session_cluster_view/1`, add a conditional drill-down section rendered when `assigns[:selected_session_id]` is non-nil: `<div id=\"causal-dag-panel\">` (delegates to Phase 3 DAG component or stub), `<div id=\"live-scratchpad-panel\">` streaming `cognition.intent` values from `assigns[:scratchpad_intents] || []`, and `<div id=\"hitl-console-panel\">` (delegates to Phase 4 HITL component or stub); add collapsib","goal":"Section 5.3 compiles from scratch matching its FRD exactly","acceptance_criteria":["mix compile --warnings-as-errors","mix test test/observatory_web/live/dashboard_live_test.exs","mix test test/observatory_web/live/session_cluster_test.exs"],"priority":"high","blocked_by":["1"],"files":["lib/observatory_web/components/registry_components.ex","lib/observatory_web/components/session_cluster_components.ex","test/observatory_web/live/dashboard_live_test.exs","test/observatory_web/live/session_cluster_test.exs"],"done_when":"mix compile --warnings-as-errors","owner":"","created":"2026-02-22T13:16:59Z","updated":"2026-02-22T13:16:59Z","tags":["phase-5","session-cluster-and-registry-views","section-5.3"],"roadmap_ref":"5.3","notes":""}
{"id":"3","status":"pending","subject":"Rewrite Scheduler and Forensic Inspector Views (Section 5.4)","description":"Section 5.4 subtasks: - [ ] 5.4.1.1 Replace the stub in `lib/observatory_web/components/scheduler_components.ex` with `scheduler_view/1` rendering: `<div id=\"scheduler-view\">` wrapper; a Cron Job Dashboard section iterating `assigns[:cron_jobs] || []` with each row carrying `class={\"cron-status-#{job.state}\"}` (where `job.state` is `\"pending\"`, `\"running\"`, or `\"failed\"`) and displaying `job.name`, `job.next_run_at`, `job.last_success_at`, and `job.consecutive_failures`; a DLQ section that either renders `<p class=\"empty-state\">No failed deliveries.</p>` when `(assigns[:dlq_entries] || []) == []` or renders each entry with a payload preview, failure reason, and `<button phx-click=\"retry_dlq_entry\" phx-value-entry_id={entry.id}>Retry</button>`; a Heartbeat Monitor section listing zombie agents `done_when: \"mix compile --warnings-as-errors\"` - [ ] 5.4.1.2 Add `|> assign(:cron_jobs, []) |> assign(:dlq_entries, []) |> assign(:zombie_agents, [])` to `mount/3`; add `handle_event(\"retry_dlq_entry\", %{\"entry_id\" => id}, socket)` in `dashboard_swarm_handlers.ex` that calls the backend re-enqueue function, updates the matching DLQ entry state to `\"pending\"` in socket assigns on success, or sets a flash error on failure `done_when: \"mix compile --warnings-as-errors\"` - [ ] 5.4.1.3 Write tests in `test/observatory_web/live/dashboard_live_test.exs` asserting: (a) `retry_dlq_entry` with a valid entry ID transitions that entry's state to `\"pending\"` and the rendered entry shows a pending indicator; (b) mounting with an empty DLQ list renders the empty-state message without raising; (c) mounting with cron jobs of states `\"pending\"`, `\"running\"`, and `\"failed\"` produces rows with CSS classes `cron-status-pending`, `cron-status-running`, and `cron-status-failed` in distinct elements `done_when: \"mix test test/observatory_web/live/dashboard_live_test.exs\"` - [ ] 5.4.2.1 Replace the stub in `lib/observatory_web/components/forensic_components.ex` with `forensic_view/1` rendering: `<div id=\"forensic-view\">` w","goal":"Section 5.4 compiles from scratch matching its FRD exactly","acceptance_criteria":["mix compile --warnings-as-errors","mix test test/observatory_web/live/dashboard_live_test.exs"],"priority":"high","blocked_by":["4"],"files":["lib/observatory_web/components/forensic_components.ex","lib/observatory_web/components/scheduler_components.ex","test/observatory_web/live/dashboard_live_test.exs"],"done_when":"mix compile --warnings-as-errors","owner":"","created":"2026-02-22T13:16:59Z","updated":"2026-02-22T13:16:59Z","tags":["phase-5","scheduler-and-forensic-inspector-views","section-5.4"],"roadmap_ref":"5.4","notes":""}
{"id":"2","status":"pending","subject":"Rewrite God Mode View and Global Instructions (Section 5.5)","description":"Section 5.5 subtasks: - [ ] 5.5.1.1 In `lib/observatory_web/live/dashboard_session_control_handlers.ex`, add: `handle_event(\"kill_switch_click\", _, socket)` setting `kill_switch_confirm_step: :first`; `handle_event(\"kill_switch_first_confirm\", _, socket)` setting `kill_switch_confirm_step: :second` (does NOT dispatch pause); `handle_event(\"kill_switch_second_confirm\", _, %{assigns: %{kill_switch_confirm_step: :second}} = socket)` calling `dispatch_mesh_pause(socket)` then resetting `kill_switch_confirm_step: nil`; `handle_event(\"kill_switch_second_confirm\", _, socket)` catch-all resetting to `nil` without dispatch; `handle_event(\"kill_switch_cancel\", _, socket)` resetting to `nil`; add `|> assign(:kill_switch_confirm_step, nil)` to `mount/3` `done_when: \"mix compile --warnings-as-errors\"` - [ ] 5.5.1.2 In `lib/observatory_web/components/god_mode_components.ex`, replace the stub with `god_mode_view/1` that renders: `<div id=\"god-mode-view\">` wrapper; a kill-switch section with class `god-mode-panel` containing a button with class `god-mode-button-danger` and `phx-click=\"kill_switch_click\"`; a first confirmation modal rendered when `assigns[:kill_switch_confirm_step] == :first` with a `Confirm` button (`phx-click=\"kill_switch_first_confirm\"`) and a `Cancel` button (`phx-click=\"kill_switch_cancel\"`); a second confirmation rendered when `kill_switch_confirm_step == :second` with the same pattern `done_when: \"mix compile --warnings-as-errors\"` - [ ] 5.5.1.3 Write tests in `test/observatory_web/live/god_mode_test.exs` asserting: (a) sending `kill_switch_click`, `kill_switch_first_confirm`, `kill_switch_second_confirm` in sequence transitions `kill_switch_confirm_step` through `nil -> :first -> :second -> nil` and the mesh pause command is dispatched; (b) sending `kill_switch_click` followed by `kill_switch_cancel` resets `kill_switch_confirm_step` to `nil` and no pause is dispatched; (c) sending only `kill_switch_click` (no subsequent events) leaves `kill_switch_confirm_step` at `:first` and n","goal":"Section 5.5 compiles from scratch matching its FRD exactly","acceptance_criteria":["mix compile --warnings-as-errors","mix test test/observatory_web/live/god_mode_test.exs"],"priority":"high","blocked_by":["3"],"files":["lib/observatory_web/components/god_mode_components.ex","lib/observatory_web/live/dashboard_session_control_handlers.ex","test/observatory_web/live/god_mode_test.exs"],"done_when":"mix compile --warnings-as-errors","owner":"","created":"2026-02-22T13:16:59Z","updated":"2026-02-22T13:16:59Z","tags":["phase-5","god-mode-view-and-global-instructions","section-5.5"],"roadmap_ref":"5.5","notes":""}
{"id":"6","status":"pending","subject":"Generate migrations and run full test suite (Phase 5 final)","description":"Final integration task for Phase 5. Generate any pending migrations, apply them, and run the complete test suite with zero failures and zero warnings. Adapt commands to the project build system.","goal":"All Phase 5 changes integrated, full test suite green","acceptance_criteria":["All pending migrations/schema changes applied","Full test suite passes with 0 failures","Build passes with zero warnings"],"priority":"critical","blocked_by":["2"],"files":[],"done_when":"echo Verify: build clean + tests green","owner":"","created":"2026-02-22T13:16:59Z","updated":"2026-02-22T13:16:59Z","tags":["phase-5","migration","final"],"roadmap_ref":"5.final","notes":"Blocks on ALL other tasks. Run all schema changes and tests in one final pass."}
