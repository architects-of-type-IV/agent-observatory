---
type: task
id: "1.2.3"
section_id: "1.2"
title: "capability_version Semver Field"
status: pending
governed_by: ["ADR-014"]
parent_uc: ["UC-0205", "UC-0206"]
---

# Task 1.2.3: capability_version Semver Field

## Goal

The `identity.capability_version` field is a required non-empty string carrying the semver version of the schema the sending agent uses. The schema itself enforces only that the field is present and non-empty; semver format checking is delegated to the Gateway's CapabilityMap lookup. The `major_version/1` helper extracts the major component from a semver string, enabling the Gateway and version registry to apply N-1 compatibility rules without parsing the string in multiple places.

## Governing Decisions

- ADR-014

## Verification UCs

- UC-0205
- UC-0206

## Subtasks

| ID | Title | Done When | Status |
|----|-------|-----------|--------|
| 1.2.3.1 | Add major_version/1 helper with nil-safe guard clause | mix compile --warnings-as-errors | pending |
| 1.2.3.2 | Write tests for major_version/1 and empty capability_version error | mix test test/observatory/mesh/decision_log_test.exs | pending |
