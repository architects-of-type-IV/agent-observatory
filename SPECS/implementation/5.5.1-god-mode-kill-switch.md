---
type: task
id: "5.5.1"
section_id: "5.5"
title: "GodModeComponents: Kill-Switch Double-Confirm State Machine"
status: pending
governed_by: ["ADR-022"]
parent_uc: ["UC-0310", "UC-0311"]
---

# Task 5.5.1: GodModeComponents: Kill-Switch Double-Confirm State Machine

## Goal

Implement the kill-switch state machine with three event handlers (`kill_switch_click`, `kill_switch_first_confirm`, `kill_switch_second_confirm`) and one cancel handler (`kill_switch_cancel`). The second confirm handler must guard that `kill_switch_confirm_step == :second` before dispatching the pause command; if not, reset to `nil` without dispatching.

## Governing Decisions

- ADR-022

## Verification UCs

- UC-0310
- UC-0311

## Subtasks

| ID | Title | Done When | Status |
|----|-------|-----------|--------|
| 5.5.1.1 | Add four kill-switch event handlers in dashboard_session_control_handlers.ex and kill_switch_confirm_step: nil in mount/3 | mix compile --warnings-as-errors | pending |
| 5.5.1.2 | Replace stub with god_mode_view/1 rendering kill-switch section with god-mode-panel and two confirmation modals | mix compile --warnings-as-errors | pending |
| 5.5.1.3 | Write tests for full click->first_confirm->second_confirm sequence, cancel reset, single click no-dispatch, and spurious second_confirm reset | mix test test/observatory_web/live/god_mode_test.exs | pending |
