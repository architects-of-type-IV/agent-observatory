---
id: "1.3.1.1"
title: "Add put_gateway_entropy_score/2 with nil cognition guard"
status: pending
task_id: "1.3.1"
governed_by: ["ADR-014", "ADR-018"]
parent_uc: ["UC-0206"]
---

goal: "Add two-clause put_gateway_entropy_score/2 to DecisionLog: one for nil cognition (no-op) and one for non-nil cognition that overwrites entropy_score"
allowed_files:
  - lib/observatory/mesh/decision_log.ex
blocked_by: ["1.1.2.2"]
steps:
  - Add def put_gateway_entropy_score(%__MODULE__{cognition: nil} = log, _score), do: log
  - Add def put_gateway_entropy_score(%__MODULE__{cognition: cognition} = log, score) when is_float(score)
  - Implement the second clause returning %{log | cognition: %{cognition | entropy_score: score}}
  - Confirm mix compile --warnings-as-errors passes
done_when: "mix compile --warnings-as-errors"
